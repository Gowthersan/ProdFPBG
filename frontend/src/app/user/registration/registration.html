<div class="min-h-screen grid place-items-center bg-[#1f3b52] px-4">
  <div
    class="w-full max-w-3xl rounded-3xl bg-[#0F2434] text-white p-8 md:p-10 shadow-2xl border border-white/10"
  >
    <!-- Logo + titre -->
    <div class="flex justify-center">
      <img src="assets/logo.png" alt="FPBG" class="h-12 w-auto" />
    </div>
    <h1 class="mt-4 text-center text-3xl font-bold">Bienvenue</h1>

    <!-- Onglets -->
    <div class="mt-6 mx-auto grid grid-cols-2 gap-6 max-w-md">
      <a
        routerLink="/login"
        class="rounded-md bg-[#1F3B52] text-slate-200 px-6 py-2 text-center font-semibold hover:bg-[#21435e] transition"
      >
        Connexion
      </a>
      <button
        type="button"
        class="rounded-md bg-green-600 hover:bg-green-500 px-6 py-2 text-center font-semibold transition"
      >
        Inscription
      </button>
    </div>

    <!-- Stepper -->
    <div class="mt-7 flex items-center justify-center gap-6">
      <div
        class="flex items-center justify-center w-8 h-8 rounded-full"
        [ngClass]="{ 'bg-green-600': step() >= 1, 'bg-[#1F3B52]': step() < 1 }"
      >
        1
      </div>
      <div class="w-12 h-0.5 bg-slate-600"></div>
      <div
        class="flex items-center justify-center w-8 h-8 rounded-full"
        [ngClass]="{ 'bg-green-600': step() === 2, 'bg-[#1F3B52]': step() !== 2 }"
      >
        2
      </div>
    </div>

    <h2 class="mt-5 text-center text-lg font-semibold">
      {{ step() === 1 ? 'Informations sur l’organisme' : 'Informations sur le Demandeur' }}
    </h2>

    <!-- Alerte erreur globale -->
    <div
      *ngIf="error()"
      class="mt-4 rounded-md border border-red-500/30 bg-red-500/10 text-red-200 px-4 py-3"
    >
      {{ error() }}
    </div>

    <!-- ===== Étape 1 : Organisme ===== -->
    <form *ngIf="step() === 1" class="mt-6 grid gap-4" [formGroup]="form" (ngSubmit)="next()">
      <!-- Nom org -->
      <div>
        <label class="block text-sm text-slate-300 mb-1">Nom de l’organisation</label>
        <input
          formControlName="orgName"
          class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
          placeholder="Association d’agriculture"
        />
        <p
          class="mt-1 text-xs text-red-300"
          *ngIf="form.get('orgName')?.touched && form.get('orgName')?.invalid"
        >
          Nom de l’organisation requis.
        </p>
      </div>

      <!-- Type org -->
      <div>
        <label class="block text-sm text-slate-300 mb-1">Type d’organisation</label>
        <select
          formControlName="orgType"
          class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
        >
          <option value="">-- Sélectionner --</option>
          <option *ngFor="let t of orgTypes" [value]="t">{{ t }}</option>
        </select>
        <p
          class="mt-1 text-xs text-red-300"
          *ngIf="form.get('orgType')?.touched && form.get('orgType')?.invalid"
        >
          Type d’organisation requis.
        </p>
      </div>

      <!-- Couverture -->
      <div>
        <label class="block text-sm text-slate-300 mb-1">Couverture géographique</label>
        <select
          formControlName="coverage"
          class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
        >
          <option value="">-- Sélectionner --</option>
          <option *ngFor="let c of coverages" [value]="c">{{ c }}</option>
        </select>
        <p
          class="mt-1 text-xs text-red-300"
          *ngIf="form.get('coverage')?.touched && form.get('coverage')?.invalid"
        >
          Couverture requise.
        </p>
      </div>

      <!-- Type de subvention -->
      <div>
        <label class="block text-sm text-slate-300 mb-1">Type de subvention</label>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
          <label
            class="flex items-center gap-2 rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5 cursor-pointer"
          >
            <input
              type="radio"
              class="accent-green-600"
              formControlName="grantType"
              value="Petite subvention"
            />
            <span>Petite subvention</span>
          </label>
          <label
            class="flex items-center gap-2 rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5 cursor-pointer"
          >
            <input
              type="radio"
              class="accent-green-600"
              formControlName="grantType"
              value="Moyenne subvention"
            />
            <span>Moyenne subvention</span>
          </label>
        </div>
        <p
          class="mt-1 text-xs text-red-300"
          *ngIf="form.get('grantType')?.touched && form.get('grantType')?.invalid"
        >
          Choisissez un type de subvention.
        </p>
      </div>

      <!-- Email/Tel org -->
      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-slate-300 mb-1">Email de contact</label>
          <input
            type="email"
            formControlName="orgEmail"
            class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
            placeholder="fpbg@gmail.com"
          />
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('orgEmail')?.touched && form.get('orgEmail')?.invalid"
          >
            Email valide requis.
          </p>
        </div>
        <div>
          <label class="block text-sm text-slate-300 mb-1">Téléphone</label>
          <input
            formControlName="orgPhone"
            class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
            placeholder="0XX XX XX XX ou +241XXXXXXXX"
          />
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('orgPhone')?.touched && form.get('orgPhone')?.hasError('required')"
          >
            Téléphone requis.
          </p>
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('orgPhone')?.touched && form.get('orgPhone')?.hasError('gabonPhone')"
          >
            Format invalide. Utilisez 0XX XX XX XX (ex. 061 23 45 67) ou +241XXXXXXXX.
          </p>
        </div>
      </div>

      <!-- Actions -->
      <div class="mt-3 flex justify-center gap-3">
        <button type="submit" [disabled]="loading()"
                class="rounded-md bg-green-600 hover:bg-green-500 px-8 py-2.5 font-semibold disabled:opacity-60 disabled:cursor-not-allowed transition">
          Suivant
        </button>
      </div>
    </form>

    <!-- ===== Étape 2 : Demandeur ===== -->
    <form *ngIf="step() === 2" class="mt-6 grid gap-4" [formGroup]="form" (ngSubmit)="submit()">
      <h2 class="text-center text-lg font-semibold">Informations sur le Demandeur</h2>

      <!-- Contact -->
      <div>
        <label class="block text-sm text-slate-300 mb-1">Personne de contact</label>
        <input
          formControlName="contact"
          class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
          placeholder="Nom Prénom"
        />
        <p
          class="mt-1 text-xs text-red-300"
          *ngIf="form.get('contact')?.touched && form.get('contact')?.invalid"
        >
          Nom du contact requis.
        </p>
      </div>

      <!-- Poste -->
      <div>
        <label class="block text-sm text-slate-300 mb-1">Fonction</label>
        <input
          formControlName="position"
          class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
          placeholder="Responsable projet"
        />
      </div>

      <!-- Tel / Email -->
      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-slate-300 mb-1">Téléphone</label>
          <input
            formControlName="phone"
            class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
            placeholder="0XX XX XX XX ou +241XXXXXXXX"
          />
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('phone')?.touched && form.get('phone')?.hasError('required')"
          >
            Téléphone requis.
          </p>
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('phone')?.touched && form.get('phone')?.hasError('gabonPhone')"
          >
            Format invalide. Utilisez 0XX XX XX XX (ex. 061 23 45 67) ou +241XXXXXXXX.
          </p>
        </div>
        <div>
          <label class="block text-sm text-slate-300 mb-1">Email</label>
          <input
            type="email"
            formControlName="email"
            class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
            placeholder="fpbg@gmail.com"
          />
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('email')?.touched && form.get('email')?.invalid"
          >
            Email valide requis.
          </p>
        </div>
      </div>

      <!-- Password / Confirm -->
      <div class="grid md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm text-slate-300 mb-1">Mot de passe</label>
          <input
            type="password"
            formControlName="password"
            class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
            placeholder="********"
          />
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="form.get('password')?.touched && form.get('password')?.invalid"
          >
            Mot de passe requis (6 caractères minimum).
          </p>
        </div>
        <div>
          <label class="block text-sm text-slate-300 mb-1">Confirmer le mot de passe</label>
          <input
            type="password"
            formControlName="confirm"
            class="w-full rounded-md bg-[#1F3B52] border border-white/10 px-4 py-2.5"
            placeholder="********"
          />
          <p
            class="mt-1 text-xs text-red-300"
            *ngIf="
              form.get('confirm')?.touched &&
              (form.get('confirm')?.invalid || form.value.password !== form.value.confirm)
            "
          >
            Confirmation invalide : les mots de passe doivent correspondre.
          </p>
        </div>
      </div>

      <!-- Actions -->
      <div class="mt-3 flex justify-center gap-3">
        <button type="button" (click)="step.set(1)"
                class="rounded-md bg-slate-600 hover:bg-slate-500 px-8 py-2.5 font-semibold transition">
          Retour
        </button>
        <button type="submit" [disabled]="loading()"
                class="rounded-md bg-green-600 hover:bg-green-500 px-8 py-2.5 font-semibold disabled:opacity-60 disabled:cursor-not-allowed transition">
          <span *ngIf="!loading()">Créer le compte</span>
          <span *ngIf="loading()">Création en cours...</span>
        </button>
      </div>
    </form>
  </div>
</div>
